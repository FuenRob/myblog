{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/configurar-docker-con-xdebug-y-vscode/","result":{"data":{"markdownRemark":{"html":"<h2>Prerrequisitos</h2>\n<p>Como mínimo, debemos tener lo siguiente instalado en nuestro ordenador:</p>\n<ul>\n<li>Docker Compose: Guía de instalación en este <a href=\"https://docs.docker.com/compose/install/\" target=\"_blank\" rel=\"nofollow\">link</a>.</li>\n<li>El IDE de desarrollo <a href=\"https://code.visualstudio.com/\" target=\"_blank\" rel=\"nofollow\">visual studio code</a>.</li>\n<li>Extensión de VS Code para debuguear en PHP, <a href=\"https://marketplace.visualstudio.com/items?itemName=felixfbecker.php-debug\" target=\"_blank\" rel=\"nofollow\">PHP Debug</a>.</li>\n</ul>\n<h2>Pasos a seguir</h2>\n<p>Lo primero que debemos hacer, en la carpeta del proyecto, es crear un fichero llamado <strong>Dockerfile</strong>, este fichero es la imagen de Docker que define la configuración de nuestro contenedor, y tiene este código:</p>\n<pre><code>FROM php:7.3-apache\n    \nRUN pecl install -f xdebug \\\n&#x26;&#x26; echo \"zend_extension=$(find /usr/local/lib/php/extensions/ -name xdebug.so)\" > /usr/local/etc/php/conf.d/xdebug.ini;\n</code></pre>\n<p>Con esta línea: <em>RUN pecl install -f xdebug \\ &#x26;&#x26; echo \"zend_extension=$(find /usr/local/lib/php/extensions/ -name xdebug.so)\" > /usr/local/etc/php/conf.d/xdebug.ini</em>, le instalamos la extensión xDebug al PHP del contenedor de Docker cuando lo levantemos.</p>\n<p>También en la raíz del proyecto vamos a crear el fichero que ejecutara la imagen de Docker que acabamos de crear, <strong>docker-compose.yml</strong>, con el siguiente contenido:</p>\n<pre><code>     version: '3'\n     \n     services:\n       web:\n        build:\n            context: .\n            dockerfile: ./Dockerfile\n        environment:\n            XDEBUG_CONFIG: remote_host=172.17.0.1 remote_port=9000 remote_enable=1\n        ports:\n            - '80:80'\n        volumes:\n            - './web:/var/www/html'\n</code></pre>\n<p>En este fichero lo que estamos haciendo es construir un contenedor de docker que tendrá un servidor Apache y la versión de PHP 7.3 con la extensión de xDebug ya instalada y configurada para poder conectar el servidor web con nuestro VS Code.</p>\n<p>En esta línea: <em>XDEBUG<em>CONFIG: remote</em>host=172.17.0.1 remote<em>port=9000 remote</em>enable=1</em> se configura el xDebug. <strong>Cambiar esto \"172.17.0.1\" por esto \"host.docker.internal\" en caso de usar Windows o Mac</strong></p>\n<p>Una vez tengamos los dos ficheros, ejecutamos el comando que creara el contenedor de Docker:</p>\n<pre><code>        docker-compose up -d\n</code></pre>\n<p>Esto no debería tardar mucho y cuando nos salga algo como esto en nuestro terminal: <em>Creating CONTAINER_NAME ... done</em>, veremos que se ha creado una carpeta llamada web. En esa carpeta es donde debemos alojar el código de nuestra plataforma web. Es posible que debas actualizar los permisos de la carpeta para poder crear contenido.</p>\n<p>Muy bien, ahora mismo tenemos mitad del camino hecho. El siguiente paso es en nuestro VS Code, ya que tenemos que configurar el xDebug.</p>\n<p>La extensión mencionada en los prerrequisitos añadirá un icono a la derecha en nuestro IDE, al pulsarlo veremos el área de gestión de xDebug:</p>\n<p><img src=\"https://github.com/felixfbecker/vscode-php-debug/raw/master/images/demo.gif\" alt=\"vscode-debug-php\"></p>\n<p>Al pulsar la tuerca pequeña de arriba, nos abre un launch.json que podremos editar. Este fichero contiene la configuración de la extensión PHP Debug, y en ella debemos editar el objeto de <strong>configurations</strong>, sustituyendo el código por el de más abajo, para que pueda conectarse al servidor del contenedor de Docker:</p>\n<p><strong>Sustituye PATH_FOLDER por tu estructura de carpetas</strong></p>\n<pre><code>     \"configurations\": [\n        {\n            \"name\": \"Listen for XDebug\",\n            \"type\": \"php\",\n            \"request\": \"launch\",\n            \"port\": 9000,\n            \"pathMappings\": {\n                \"/var/www/html\": \"PATH_FOLDER/web\"\n            },\n            \"xdebugSettings\": {\n                \"max_data\": 65535,\n                \"show_hidden\": 1,\n                \"max_children\": 100,\n                \"max_depth\": 5\n            }\n        }\n       ]\n</code></pre>\n<p>Cuando hayamos editado este fichero, lo guardamos y vamos a la carpeta web para crear un fichero, <strong>index.php</strong>:</p>\n<pre><code>    &#x3C;?php\n    echo \"hello world!\"\n    ?>\n</code></pre>\n<p>Y ponemos el punto de debug en el <strong>echo</strong>. Al abrir un navegador y poner la url <a href=\"http://localhost/\" target=\"_blank\" rel=\"nofollow\">http://localhost/</a>, verás como automáticamente se abre tu VS Code con el código de tu index.php y la línea del echo marcada, normalmente con un subrayado amarillo. Esto quiere decir que la ejecución del código se ha parado en el punto de debug o de ruptura, como prefieras llamarlo. Ahora mismo ya tienes tu contenedor web de Docker con el xDebug configurado y conectado a tu VS Code.</p>\n<p>En caso de que no te coja el punto de debug automáticamente, puedes activar el modo debug del VS Code pulsando en el triangulo de play verde que se ve en esa ventana del IDE.</p>","frontmatter":{"title":"Configurar Docker con xDebug y VSCode","cover":{"publicURL":"/mysite/static/466c7fe618f63d32b0272d13185dfd52/dockerphp.png","childImageSharp":{"sizes":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAA7CAAAOwgEVKEqAAAABcUlEQVQY022QS0sCYRSG/Qe1kSAKc77vm3GMXLRv1yboP7TrZxi0DLqRmA0oSRdHp1FHp7lloWGbguxqlk2paOa1+gd9alFm8C4OnPOc9z3HAJXajw7eULRo8Z5CrQHVGlQbXd0eGb4qtY5JwCTIeQ9ldwG5RnL3UMhBpdpqae0teBeulfpfGIkvpDtJz23QdhdtX6fXJOg+GXaoSCxBuYrCOShXcCi4X25JrnzDchWoDYrPDi5FjK74AJPoZ5J9q9rQikQF7rAVtXU+usBZHSrt1KzLAu2MYad2hI4z5mMfJHszy8ehJ2FYVIyOIxAtwdg7DomEAtrLwkAG+dMkl0FBvedmuYpvton5cfYCcA9IquB4mAdi2Sy9WpQKLZVHIkWAJ7XmP7BZbY75UlOMAH3XJi47waVm2EPA3pp4fXLneNobM/nSMPjUCdwN469qDcA/EptnIKgT4TwV0m3+SxB6BkKB2L0itlMErxNC4Tf8CaiUDj+p3RaoAAAAAElFTkSuQmCC","aspectRatio":2.5,"src":"/mysite/static/466c7fe618f63d32b0272d13185dfd52/6bc03/dockerphp.png","srcSet":"/mysite/static/466c7fe618f63d32b0272d13185dfd52/46604/dockerphp.png 500w,\n/mysite/static/466c7fe618f63d32b0272d13185dfd52/6bc03/dockerphp.png 825w","sizes":"(max-width: 825px) 100vw, 825px"}}}}}},"pageContext":{"slug":"/blog/configurar-docker-con-xdebug-y-vscode/"}}}