{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/usar-prestashop-17-con-docker-compose/","result":{"data":{"markdownRemark":{"html":"<p>En esta publicación os contaré lo que hice para montar PrestaShop 1.7 con docker-compose sin usar la imagen oficial de Docker para PrestaShop. Lo primero es crear nuestro Dockerfile en el que indicaremos la versión de PHP y servidor que vamos a utilizar. En mi caso usé la imagen de php:7.2-apache y yo le indiqué que extensiones habilitar.</p>\n<pre><code>FROM php:7.2-apache\n\nRUN pecl install -f xdebug \\\n    &#x26;&#x26; echo \"zend_extension=$(find /usr/local/lib/php/extensions/ -name xdebug.so)\" > /usr/local/etc/php/conf.d/xdebug.ini;\n\nRUN apt-get update &#x26;&#x26; apt-get install -y \\\n    libfreetype6-dev \\\n    libjpeg62-turbo-dev \\\n    libpng-dev \\\n    &#x26;&#x26; docker-php-ext-install -j$(nproc) iconv \\\n    &#x26;&#x26; docker-php-ext-configure gd --with-freetype-dir=/usr/include/ --with-jpeg-dir=/usr/include/ \\\n    &#x26;&#x26; docker-php-ext-install -j$(nproc) gd \\\n    &#x26;&#x26; docker-php-ext-install mysqli pdo pdo_mysql zip\n\nADD https://raw.githubusercontent.com/mlocati/docker-php-extension-installer/master/install-php-extensions /usr/local/bin/\n\nRUN chmod uga+x /usr/local/bin/install-php-extensions &#x26;&#x26; sync &#x26;&#x26; \\\n    install-php-extensions intl bcmath imagick memcached\n\nRUN a2enmod rewrite\n</code></pre>\n<p>Después vamos a crear el fichero docker-compose.yml, que será el que levantará los contenedores.</p>\n<pre><code>version: '3.3'\n\nservices:\n    db:\n        image: mysql:5.7.22\n        container_name: serverdb\n        command: --sql_mode=\"\"\n        restart: always\n        environment:\n            - MYSQL_DATABASE=prestashop\n            - MYSQL_ROOT_PASSWORD=root_password\n            - MYSQL_USER=prestashop\n            - MYSQL_PASSWORD=prestashop\n        ports:\n            - \"13306:3306\"\n        volumes:\n            - \"./data/db/mysql:/var/lib/mysql\"\n    web:\n        build:\n            context: .\n            dockerfile: ./Dockerfile\n        environment:\n            XDEBUG_CONFIG: remote_host=172.17.0.1 remote_port=9000 remote_enable=1\n        ports:\n            - '80:80'\n        volumes:\n            - './web:/var/www/html'\n        depends_on:\n            - db\n</code></pre>\n<p>Una vez tengamos ambos ficheros listos, vamos a levantar nuestros entornos de docker lanzado el siguiente comando en nuestra terminal o consola:</p>\n<pre><code>docker-compose up -d\n</code></pre>\n<p>Si todo ha salido bien, en nuestra carpeta de proyecto y al mismo nivel que nuestro fichero docker-compose.yml, se nos habrán creado tres carpetas. Una es <strong>data</strong>, contiene toda la base de datos, la otra es <strong>etc</strong>, que contiene toda la configuración de servidor web, y por último una llamada <strong>web</strong>, es en la que tenemos que añadir nuestro código. En este caso, es en esa carpeta donde pondríamos los archivos para instalar PrestaShop 1.7 en local.\n<strong>Es posible que tengas que ajustar los permisos para poder mover los fichero dentro de la carpeta web</strong>\nAhora que ya tenemos todos los servicios levantados, vamos a entrar en el servidor de base de datos ejecutando en nuestro terminal el siguiente comando:</p>\n<pre><code>docker-compose exec db mysql -h localhost -u root -p\n</code></pre>\n<p>Una vez dentro del servidor de base de datos, vamos a darle permisos totales al usuario que queremos usar para conectar nuestra plataforma PHP con nuestra base de datos, primero creando el usuario en caso de que no esté creado ya:</p>\n<pre><code>CREATE USER 'root'@'%' IDENTIFIED BY 'root_password';\n</code></pre>\n<p>Después le vamos a dar privilegios/permisos para ejecutar acciones en el servidor de base de datos:</p>\n<pre><code>GRANT ALL PRIVILEGES ON *.* TO 'root'@'%' WITH GRANT OPTION;\n</code></pre>\n<p>Y por último, vamos a refrescar esos privilegios para que coja la nueva configuración:</p>\n<pre><code>FLUSH PRIVILEGES;\n</code></pre>\n<p>Al hacer esto nos hemos asegurado de que nuestro usuario de base de datos puede hacer lo que quiera sobre las bases de datos y sus tablas.\nAhora mismo ya podemos iniciar el proceso de instalación de Prestashop. Si hemos copiado los ficheros de instalación en la carpeta web, nos vale con poner <em><a href=\"http://localhost\" target=\"_blank\" rel=\"nofollow\">http://localhost</a></em> en nuestro navegador.</p>","frontmatter":{"title":"Usar Prestashop 1.7 con Docker Compose","date":"2020-05-23","cover":{"publicURL":"/static/13f79d1fb92f130327434f44b966716d/image-post1.jpeg","childImageSharp":{"sizes":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAEDAgX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAAB49sOICK//8QAGhAAAgIDAAAAAAAAAAAAAAAAAAECIRARQf/aAAgBAQABBQLrsomtSx//xAAVEQEBAAAAAAAAAAAAAAAAAAABEP/aAAgBAwEBPwFn/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFRABAQAAAAAAAAAAAAAAAAAAEIH/2gAIAQEABj8CY//EABwQAAIDAAMBAAAAAAAAAAAAAAABESExQXGRof/aAAgBAQABPyFuXfTOWF6O2fRFAmoeD0//2gAMAwEAAgADAAAAEI8P/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxAf/8QAFREBAQAAAAAAAAAAAAAAAAAAARD/2gAIAQIBAT8QJ//EABsQAQEBAAIDAAAAAAAAAAAAAAERADGBIUGh/9oACAEBAAE/EG8NXBJSvQ0EX1kCYNfdx0fYGXcm/9k=","aspectRatio":1.4970059880239521,"src":"/static/13f79d1fb92f130327434f44b966716d/a7715/image-post1.jpg","srcSet":"/static/13f79d1fb92f130327434f44b966716d/0f3a1/image-post1.jpg 500w,\n/static/13f79d1fb92f130327434f44b966716d/a7715/image-post1.jpg 1000w","sizes":"(max-width: 1000px) 100vw, 1000px"}}}},"fields":{"slug":"/blog/usar-prestashop-17-con-docker-compose/"}},"site":{"siteMetadata":{"comments":{"GATSBY_DISQUS_NAME":"fuenrob.disqus.com"}}}},"pageContext":{"slug":"/blog/usar-prestashop-17-con-docker-compose/"}}}